## comments

Guide to running ADMIXTURE

1) Convert vcf file to plink format (.bed, .bim, and .fam files) as required by ADMIXTURE
	- Use plink2 to convert vcf to plink
	- plink can't deal with chromosome IDs that are not human unless the flag --allow-extra-chr is used
	- This flag only works if the chromosome IDs start with a letter
	- So first, add an 'X' at the start of chromosomes IDs in R: gal.vcf@fix[, 1] <- paste0("X", gal.vcf@fix[, 1]), then save this vcf to a file: write.vcf(gal.vcf, "path/galvcf_plink.vcf.gz")

2) Convert from vcf to plink using plink2: plink2 --vcf galvcf_plink.vcf.gz --make-bed --out galplink --allow-extra-chr

3) ADMIXTURE does not accept chromosome names that are not human chromosomes - replace the first column (with chromosome IDs) with 0: awk '{$1=0;print $0}' galplink.bim > galplink.bim.tmp; mv galplink.bim.tmp galplink.bim

4) Run ADMIXTURE with varying number of K:
	for K in {1..8}; do /home/cristobg/tn20_scratch/Cris/genetics/dist/admixture_linux-1.3.0/admixture --cv galplink.bed $K | tee gal_log${K}.out; done

5) See CV errors: grep -h CV gal_log*.out

6) Run ADMIXTURE at K = 2 <whatever value minimizes error>: /home/cristobg/tn20_scratch/Cris/genetics/dist/admixture_linux-1.3.0/admixture galplink.bed 2


https://speciationgenomics.github.io/ADMIXTURE/

## comments


plink2 --vcf vcf_plink.vcf.gz --make-bed --out galplink --allow-extra-chr
awk '{$1=0;print $0}' galplink.bim > galplink.bim.tmp; mv galplink.bim.tmp galplink.bim
for K in {1..8}; do /home/cristobg/tn20_scratch/Cris/genetics/dist/admixture_linux-1.3.0/admixture --cv galplink.bed $K | tee gal_log${K}.out; done
grep -h CV gal_log*.out
home/cristobg/tn20_scratch/Cris/genetics/dist/admixture_linux-1.3.0/admixture galplink.bed 2



