## ustacks

FILES="Site_01-G01
Site_01-G02
Site_01-G03
Site_01-G04
Site_01-G05
Site_01-G06
Site_01-G07
Site_01-G08
Site_01-G09
Site_01-G10
Site_01-G11
Site_01-G13
Site_01-G15
Site_01-G16
Site_02-CO01
Site_02-CO02
Site_02-CO03
Site_02-CO04
Site_02-CO05
Site_02-CO06
Site_02-CO07
Site_02-CO08
Site_02-CO09
Site_02-CO10
Site_03-AB01
Site_03-AB02
Site_03-AB03
Site_03-AB04
Site_03-AB05
Site_03-AB06
Site_03-AB07
Site_03-AB08
Site_03-AB09
Site_03-AB10
Site_04-KR01
Site_04-KR02
Site_04-KR03
Site_04-KR04
Site_04-KR05
Site_04-KR06
Site_04-KR07
Site_04-KR08
Site_04-KR09
Site_04-KR10
Site_04-KR11
Site_04-KR14
Site_04-KR15
Site_04-KR16
Site_04-KR17
Site_05-L01
Site_05-L02
Site_05-L03
Site_05-L04
Site_05-L05
Site_05-L06
Site_05-L07
Site_05-L08
Site_05-L09
Site_05-L10
Site_06-A01
Site_06-A02
Site_06-A03
Site_06-A04
Site_06-A05
Site_06-A06
Site_06-A07
Site_06-A08
Site_06-A09
Site_06-A10
Site_06-A11
Site_06-A12
Site_06-A13
Site_06-A14
Site_06-A15
Site_07-T01
Site_07-T02
Site_07-T03
Site_07-T04
Site_07-T05
Site_07-T06
Site_07-T07
Site_07-T08
Site_07-T09
Site_07-T10
Site_07-T11
Site_07-T12
Site_07-T13
Site_07-T14
Site_07-T15
Site_08-Q01
Site_08-Q02
Site_08-Q03
Site_08-Q04
Site_08-Q05
Site_08-Q06
Site_08-Q07
Site_08-Q08
Site_08-Q09
Site_08-Q10
Site_08-Q11
Site_08-Q12
Site_09-DB01
Site_09-DB02
Site_09-DB03
Site_09-DB04
Site_09-DB05
Site_09-DB06
Site_09-DB07
Site_09-DB08
Site_09-DB09
Site_09-DB10
Site_10-F01
Site_10-F02
Site_10-F03
Site_10-F04
Site_10-F05
Site_10-F06
Site_10-F07
Site_10-F08
Site_10-F09
Site_10-F10
Site_11-YB01
Site_11-YB02
Site_11-YB03
Site_11-YB04
Site_11-YB05
Site_11-YB06
Site_11-YB07
Site_11-YB08
Site_11-YB09
Site_11-YB10
Site_12-CW01
Site_12-CW02
Site_12-CW03
Site_12-CW04
Site_12-CW05
Site_12-CW06
Site_12-CW07
Site_12-CW08
Site_12-CW09
Site_12-CW10
Site_12-CW11
Site_12-CW15
Site_12-CW16
Site_12-CW17
Site_13-K01
Site_13-K02
Site_13-K03
Site_13-K04
Site_13-K05
Site_13-K06
Site_13-K07
Site_13-K08
Site_13-K09
Site_13-K10
Site_14-EN01
Site_14-EN02
Site_14-EN03
Site_14-EN04
Site_14-EN05
Site_14-EN06
Site_14-EN07
Site_14-EN08
Site_14-EN09
Site_14-EN10
Site_15-W01
Site_15-W02
Site_15-W03
Site_15-W04
Site_15-W05
Site_15-W06
Site_15-W07
Site_15-W08
Site_15-W09
Site_15-W10
Site_16-PiB01
Site_16-PiB02
Site_16-PiB03
Site_16-PiB04
Site_16-PiB05
Site_16-PiB06
Site_16-PiB07
Site_16-PiB08
Site_16-PiB09
Site_16-PiB10
Site_17-NB01
Site_17-NB02
Site_17-NB03
Site_17-NB04
Site_17-NB05
Site_17-NB06
Site_17-NB07
Site_17-NB08
Site_17-NB09
Site_17-NB10
Site_18-SC01
Site_18-SC02
Site_18-SC03
Site_18-SC04
Site_18-SC05
Site_18-SC06
Site_18-SC07
Site_18-SC08
Site_18-SC09
Site_18-SC10
Site_18-SC11
Site_18-SC12
Site_18-SC13
Site_18-SC14
Site_18-SC15
Site_18-SC17
Site_19-Y01
Site_19-Y02
Site_19-Y03
Site_19-Y04
Site_19-Y05
Site_19-Y06
Site_19-Y07
Site_19-Y08
Site_19-Y09
Site_19-Y10
Site_20-RB01
Site_20-RB02
Site_20-RB03
Site_20-RB04
Site_20-RB05
Site_20-RB06
Site_20-RB07
Site_20-RB08
Site_20-RB09
Site_20-RB10
Site_21-SR01
Site_21-SR02
Site_21-SR03
Site_21-SR04
Site_21-SR05
Site_21-SR06
Site_21-SR07
Site_21-SR08
Site_21-SR09
Site_21-SR10
Site_22-PY01
Site_22-PY02
Site_22-PY03
Site_22-PY04
Site_22-PY05
Site_22-PY06
Site_22-PY07
Site_22-PY08
Site_22-PY09
Site_22-PY10
Site_23-CR01
Site_23-CR02
Site_23-CR03
Site_23-CR04
Site_23-CR05
Site_23-CR06
Site_23-CR07
Site_23-CR08
Site_23-CR09
Site_23-CR10
Site_24-FC01
Site_24-FC02
Site_24-FC03
Site_24-FC04
Site_24-FC05
Site_24-FC06
Site_24-FC07
Site_24-FC08
Site_24-FC09
Site_24-FC10
Site_25-PeB01
Site_25-PeB02
Site_25-PeB03
Site_25-PeB04
Site_25-PeB05
Site_25-PeB06
Site_25-PeB07
Site_25-PeB08
Site_25-PeB09
Site_25-PeB10
Site_26-Ma01
Site_26-Ma02
Site_26-Ma03
Site_26-Ma04
Site_26-Ma05
Site_26-Ma06
Site_26-Ma07
Site_26-Ma08
Site_26-Ma09
Site_26-Ma10
Site_27-CH01
Site_27-CH02
Site_27-CH03
Site_27-CH04
Site_27-CH05
Site_27-CH06
Site_27-CH07
Site_27-CH08
Site_27-CH09
Site_27-CH10
Site_28-Gr01
Site_28-Gr02
Site_28-Gr03
Site_28-Gr04
Site_28-Gr05
Site_28-Gr06
Site_28-Gr07
Site_28-Gr08
Site_28-Gr09
Site_28-Gr10
Site_29-E01
Site_29-E02
Site_29-E03
Site_29-E04
Site_29-E05
Site_29-E06
Site_29-E07
Site_29-E08
Site_29-E09
Site_29-E10
Site_30-Me01
Site_30-Me02
Site_30-Me03
Site_30-Me04
Site_30-Me05
Site_30-Me06
Site_30-Me07
Site_30-Me08
Site_30-Me09
Site_30-Me10"

OUTPUT=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/

module load gcc/8.1.0
ulimit -n 2048
id=1
for sample in $FILES
do
    INPUT=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/samples/combined/${sample}.1.fq.gz
    /home/cristobg/tn20_scratch/Cris/genetics/bin/ustacks -f $INPUT -o $OUTPUT -i $id --name $sample -m 3 -M 5 -p 8
    let "id+=1"
done 

## stacks

STACKS=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/
POPMAP=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/popmap.txt

module load gcc/8.1.0
ulimit -n 2048
/home/cristobg/tn20_scratch/Cris/genetics/bin/cstacks -n 5 -P $STACKS -M $POPMAP -p 12

## sstacks

STACKS=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/
POPMAP=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/popmap.txt

module load gcc/8.1.0
ulimit -n 2048
/home/cristobg/tn20_scratch/Cris/genetics/bin/sstacks -P $STACKS -M $POPMAP -p 16

## tsv2bam

STACKS=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/
POPMAP=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/popmap.txt
SAMPLES=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/samples/combined/

module load gcc/8.1.0
ulimit -n 2048
/home/cristobg/tn20_scratch/Cris/genetics/bin/tsv2bam -P $STACKS -M $POPMAP -R $SAMPLES -t 16

## gstacks

STACKS=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/
POPMAP=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/popmap.txt

module load gcc/8.1.0
ulimit -n 2048
/home/cristobg/tn20_scratch/Cris/genetics/bin/gstacks -P $STACKS -M $POPMAP -t 16

## populations

STACKS=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/stacks/
POPMAP=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/popmap.txt
OUTPUT=/home/cristobg/tn20_scratch/Cris/genetics/re-sequencing/pop_output/

module load gcc/8.1.0
ulimit -n 2048
/home/cristobg/tn20_scratch/Cris/genetics/bin/populations -P $STACKS -M $POPMAP -O $OUTPUT -t 16 --vcf --genepop --structure --fstats --hwe --min_maf 0.01












