# Split data sets between species

# Read vcf files
file <- "~/reduced_SNPs.vcf.gz.vcf.gz"
gal_reduced.vcf <- read.vcfR(file)
file <- "~/large_SNPs.vcf.gz.vcf.gz"
gal_large.vcf <- read.vcfR(file)

# admixturedata obtained from "7) Admixture.R"

# Run accordingly for reduced or large SNP set
gal.vcf <- gal_reduced.vcf
gal.vcf <- gal_large.vcf

# G caespitosa
caesindex <- c(TRUE, admixturedata$adcoef[admixturedata$group == "k1"] > 0.5)
caes.vcf <- gal.vcf
caes.vcf@gt <- caes.vcf@gt[ , caesindex]
caes.vcf
write.vcf(caes.vcf, "~/SNPs_caes_BIG.vcf")
write.vcf(caes.vcf, "~/SNPs_caes_SMALL.vcf")

# G. gemineoa
gemindex <- c(TRUE, admixturedata$adcoef[admixturedata$group == "k1"] < 0.5)
gem.vcf <- gal.vcf
gem.vcf@gt <- gem.vcf@gt[ , gemindex]
gem.vcf
write.vcf(gem.vcf, "~/SNPs_gem_BIG.vcf")
write.vcf(gem.vcf, "~/SNPs_gem_SMALL.vcf")

# Create species split csv file for downstream analyse
spSplit <- read.table("~/popmap.txt")
spSplit$caes <- caesindex
spSplit$gem <- gemindex
write.csv(spSplit, "~/species_split.csv")






